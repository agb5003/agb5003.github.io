<!DOCTYPE html><html><head>
      <title>CAPS_12_C2TB1702</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p,html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div{display:inline}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  300px/2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="report-12">Report 12</h1>

<p>Maximilian Fernaldy - C2TB1702</p>
<h2 class="mume-header" id="introduction-to-linear-classification-and-basic-machine-learning">Introduction to linear classification and basic machine learning</h2>

<p>Machine learning is defined as the process by which a computer can improve its performance at various tasks by continuously incorporating new data into a previously existing statistical model. In the context of image recognition, the machine learns by recognizing patterns and shapes in many images, training itself to be better and better at identifying the same shapes and patterns in other images, which will in turn increase its predictive accuracy.</p>
<p>Machine learning is built on many concepts, but perhaps the most basic of them is linear classification. Linear classification is a method of differentiating <em>classes</em> of data by essentially drawing lines that exist between said classes. In a two-dimensional data space, linear classification draws a line such that the distance between the nearest points on the different classes are as far as possible from the line. We know that the linear equivalent of a line in three dimensional space is a plane, so in 3D space, linear classification draws a plane that is as far as possible from the nearest data points in different classes.</p>
<figure>
  <p align="center"> <img src="./resources/linearclassification.png" width="300"> </p>
  <figcaption>Figure 1 - Linear classification in 2 dimensions</figcaption>
</figure>
<p>When there are more than 2 classes, we distinguish the different classes from each other by using one-versus-the-rest classification. This is done by using a model <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> that is defined by training it with a dataset. Once training is done, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> can then be used to assign scores to an object that needs to be classified. The object is then assigned to the class with the highest <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> score.</p>
<h3 class="mume-header" id="an-example">An example</h3>

<p>It is hard to explain machine learning with code, but it is in actuality very easy to comprehend if we use basic every day concepts. Suppose we are moving into a new house. We just bought a new robot who we need to train so that when we need to unpack after moving, the robot can help us unpack the many furniture and appliances and place them in the correct room. Maybe we do this by showing it all the different things we have in our old home and tell it where each of them belongs. The smart software inside the robot will then construct a table that scores each object based on its properties:</p>
<table>
<thead>
<tr>
<th>Variables</th>
<th style="text-align:center">Kitchen</th>
<th style="text-align:center">Garage</th>
<th style="text-align:center">Bedroom</th>
<th style="text-align:center">Living Room</th>
</tr>
</thead>
<tbody>
<tr>
<td>Is made of wood</td>
<td style="text-align:center">+3</td>
<td style="text-align:center">+1</td>
<td style="text-align:center">+4</td>
<td style="text-align:center">+4</td>
</tr>
<tr>
<td>Is made of fabric</td>
<td style="text-align:center">-1</td>
<td style="text-align:center">-4</td>
<td style="text-align:center">+5</td>
<td style="text-align:center">+4</td>
</tr>
<tr>
<td>Is made of plastic</td>
<td style="text-align:center">+4</td>
<td style="text-align:center">+1</td>
<td style="text-align:center">+2</td>
<td style="text-align:center">+2</td>
</tr>
<tr>
<td>Makes beeping noises</td>
<td style="text-align:center">+5</td>
<td style="text-align:center">+2</td>
<td style="text-align:center">-3</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>Has a remote control</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">+2</td>
<td style="text-align:center">+3</td>
</tr>
</tbody>
</table>
<p>The system tells the smart robot to assign the scores according to what characteristics an item exhibits. For example, a blender. The blender is made out of plastic, makes beeping noises and doesn&apos;t have a remote control. Therefore the robot scores the blender as follows:</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center">Kitchen</th>
<th style="text-align:center">Garage</th>
<th style="text-align:center">Bedroom</th>
<th style="text-align:center">Living Room</th>
</tr>
</thead>
<tbody>
<tr>
<td>Score</td>
<td style="text-align:center">9</td>
<td style="text-align:center">3</td>
<td style="text-align:center">-1</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<p>The robot finds out that the score for blender is highest for the class &quot;Kitchen&quot;, so the robot correctly decides to put it in the kitchen.</p>
<p>This is a simplified version of what an actual machine learning software does, but it covers the basics. The score here is what we&apos;ve previously denoted by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the score for kitchen, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the score for Garage, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> the score for Bedroom and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">y_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> the score for Living Room. Since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> gave the largest score, the blender was classified into the first class, &quot;Kitchen&quot;. The process of showing the robot all the things we have in our old home is called <em>training</em> the model, and the robot deciding where the things belong after we moved is the <em>prediction</em>.</p>
<p>In the scoring table that the robot has constructed, there are 5 different properties that it looks for. In real machine learning cases, there are <em>many, many</em> more properties. The robot only uses 5 &quot;dimensions&quot; to determine the scoring, but in reality, these dimensions are also defined by <em>other</em> dimensions. The robot has to first recognize shapes and patterns of human-made objects, which needs higher dimension machine learning in the first place. However, more dimensions does not mean <em>nonlinear</em> classification has to be used. Linear classification is not exclusive to 2D and 3D space&#x2014;it is universal and can be used with however many variables and properties. Do note, though, that linear classification is not the <em>only</em> type of classification that can be used. Often we will encounter problems that are best solved with other classification methods. In fact, the problem we encountered in this example is probably not best solved using linear classification. There are some household appliances that would be classified together with linear classification, but belong in different places. For example, toilet paper looks similar to oil blotting paper used in the kitchen. They are both made out of wood pulp, shaped like rolls and are white in color. Yet they belong in very different places. Linear classification struggles with these occurrences as the different classes are shaped like Venn diagrams: part of the same larger class, but with a few distinctive characteristics that set them apart, without a clear &quot;direction&quot; of where the differences lie.</p>
<p>In addition, in a real machine learning development process, we don&apos;t use the same objects we used for training for validation as well&#x2014;we use different datasets. But in principle, with machine learning, our goal is to to train a model to identify objects, so that it can be very good at classification, doing it much faster, or even in some incredible cases, <em>more accurately</em> than humans.</p>
<h2 class="mume-header" id="what-was-done-in-lecture-12">What was done in Lecture 12</h2>

<p>As the things done in lecture 12 are a prerequisite of Exercise 12.1, it is necessary to understand first what was done, in order to understand what needs to be done in the exercise.</p>
<h3 class="mume-header" id="loading-the-mnist-dataset-into-octave">Loading the MNIST dataset into Octave</h3>

<p>The MNIST dataset, or the Modified National Institute of Standards and Technology dataset, is a large database of handwritten digits commonly used for training image recognition and processing software. The original NIST dataset had its training dataset taken from the handwriting of the American Census Bureau employees, while the validation/testing dataset was taken from the handwriting of American high school students. Obviously this is not suitable for machine learning purposes, as the two datasets are certain to have distinct characteristics. This is why the creators of MNIST decided to modify the dataset by mixing the two datasets together in order to attain a better singular set for both training and validation purposes in machine learning.</p>
<p>The MNIST dataset has a certain format that has not been covered in the prior lectures. The database is stored in binary files, which means to use it in Octave, we need to first read them in a different way than the usual <code>imread</code>. After downloading <code>t10k-labels-idx1-ubyte</code> and <code>t10k-images-idx3-ubyte</code>, we can read the contents in Octave using the built-in C-style I/O functions:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token comment">% Loading C-style binary files</span>
<span class="token comment">% Loading the corresponding labels</span>
fid<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&apos;./mnist/t10k-labels.idx1-ubyte&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;r&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&apos;int32&apos;</span><span class="token punctuation">)</span>
label <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token string">&apos;uint8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span>fid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% Loading the images</span>
fid <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&apos;./mnist/t10k-images.idx3-ubyte&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;r&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&apos;int32&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;uint8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span>fid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><em>Note that the binaries are stored in a subfolder <code>./mnist/</code> instead of the root for organizing purposes, hence wthe use of <code>fopen(&apos;./mnist/filename/&apos;)</code> instead of just <code>fopen(&apos;filename&apos;)</code>.</em></p>
<p>The full format specifications of the two binary files is on <a href="https://yann.lecun.com/exdb/mnist">this</a> website, but we can see on the preview tables that the first entries of the two files are not the actual image data. In the labels file, the first two entries are occupied by metadata (information about the characteristics of the file itself), while in the images file, metadata occupies the first 4 entries. The first byte of actual data that we want starts at the 8<sup>th</sup> byte in the labels file and the 16<sup>th</sup> byte in the images file. This is why we need to skip the first few bytes of the file, so that we don&apos;t get a file that is shifted by a few bytes, breaking the whole model that we want to train.</p>
<figure>
  <p align="center"> <img src="./resources/whyskip.png" width="500"> </p>
  <figcaption>Figure 2 - Why the first few bytes are skipped.</figcaption>
</figure>
<p><em>Note that the preview above is not for the files that we used, and instead for a larger set of 60000 items. However, the format is the same, and only the size differs.</em></p>
<p>To correctly load the labels in <code>t10k-labels-idx1-ubyte</code>, we open the file, assign it to a file ID <code>fid</code> and read from it:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token comment">% Loading the corresponding labels</span>
fid<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&apos;./mnist/t10k-labels.idx1-ubyte&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;r&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&apos;int32&apos;</span><span class="token punctuation">)</span>
</pre><p>The last line reads the first 2 signed 32-bit integers and assigns them to nothing (essentially skipping them). Continuing with the rest of the file, we write them to a variable called <code>label</code>:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab">label <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token string">&apos;uint8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span>fid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Skip first two integers</span>
</pre><p>continuing to read from <code>fid</code>, we tell <code>fread()</code> to get 10000 unsigned 8-bit integers, which are our labels. and close the file after that so we can load other binary files.</p>
<p>To correctly read the image data from <code>t10k-images-idx3-ubyte</code>, we do the same things we did for the labels file, but we skip the first four integers instead:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token comment">% Loading the images</span>
fid <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&apos;./mnist/t10k-images.idx3-ubyte&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;r&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&apos;int32&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Skip first four integers</span>
data <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;uint8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span>fid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This time, <code>fread()</code> is told to get a matrix with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>28</mn><mo>&#xD7;</mo><mn>28</mn><mo>=</mo><mn>784</mn></mrow><annotation encoding="application/x-tex">28 \times 28 = 784</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">28</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">28</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">784</span></span></span></span> rows and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10000</mn></mrow><annotation encoding="application/x-tex">10000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10000</span></span></span></span> columns. The rows represent different pixels in all the images, while the columns represent the amount of different images we have. As a consequence, we can imagine each column to be the column vector representation of the information contained in every pixel in that specific image.</p>
<p>The image data is stored by assigning pixel information in unsigned bytes, hence the precision indicator <code>&apos;uint8&apos;</code> used in <code>fread()</code> (1 byte is 8 bits in size, allowing them to store up to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>8</mn><mn>2</mn></msup><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">8^2 = 64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">64</span></span></span></span> levels of brightness). This is plenty for basic handwriting recognition, as we only need to have the model recognize shapes and patterns of the images.</p>
<h3 class="mume-header" id="using-liblinear-for-linear-classification">Using <code>liblinear</code> for linear classification</h3>

<p>As explained in the introduction, linear classification works by distinguishing one class of objects to others. We are essentially drawing lines between clusters of objects , so that we can accurately identify new objects.</p>
<p><code>liblinear</code> is a linear classification library created by the Machine Learning Group at National Taiwan University. After downloading the master directory from <a href="https://github.com/cjlin1/liblinear">the GitHub repository,</a> the library can be incorporated into Octave by running the pre-made <code>make.m</code> script and adding the appropriate directory to Octave&apos;s search paths. This will allow us to use the functions and utilities defined by <code>liblinear</code>, but doesn&apos;t exist in vanilla Octave, such as the functions <code>train()</code>, <code>predict()</code>, model weights <code>model.w</code> and the model labels <code>model.Label</code>.</p>
<p>Assuming the folder <code>liblinear</code> was installed then moved inside the root folder of the project, the following can be done inside Octave command window to initialize <code>liblinear</code> for the first time:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab">run <span class="token operator">./</span>liblinear<span class="token operator">/</span>matlab<span class="token operator">/</span>make
addpath <span class="token operator">./</span>liblinear<span class="token operator">/</span>matlab<span class="token operator">/</span>
</pre><p>Which runs the pre-made script <code>make.m</code> and adds the <code>matlab/</code> directory to Octave&apos;s search paths.</p>
<p><em>For reference, this was my file hierarchy when working on report 12:</em></p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab">coursework<span class="token operator">/</span>
  CAPS<span class="token operator">/</span>
    <span class="token number">12</span><span class="token operator">/</span> <span class="token comment">% Project root folder</span>
      mnist<span class="token operator">/</span>
      liblinear<span class="token operator">/</span> <span class="token comment">% Liblinear master directory</span>
        matlab<span class="token operator">/</span>
          make<span class="token punctuation">.</span>m
          <span class="token punctuation">...</span>
        windows<span class="token operator">/</span>
        python<span class="token operator">/</span>
        blas<span class="token operator">/</span>
      resources<span class="token operator">/</span> <span class="token comment">% Images and figures</span>
      CAPS_12_C2TB1702<span class="token punctuation">.</span>md <span class="token comment">% Markdown file for report writing</span>
      CAPS_12_C2TB1702_learnDigits<span class="token punctuation">.</span>m <span class="token comment">% Main script</span>
</pre><p><em><code>12/</code> is the project&apos;s root folder. Inside it are the folder containing mnist datasets, <code>liblinear</code> and the main script itself. When running the script, it is crucial to stay inside this main directory, so that the loading of files and libraries doesn&apos;t fail.</em></p>
<h3 class="mume-header" id="portioning-data-for-training-and-validation">Portioning data for training and validation</h3>

<p>In machine training, we need a training dataset and a validation dataset. The training dataset is used to create the model, while the validation dataset is used to check its prediction accuracy. For the purposes of this exercise, we will use the first 5000 images to train the model, then use the next 1000 to validate it.</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token comment">% Dedicate 5000 samples to train a model</span>
tr_label <span class="token operator">=</span> <span class="token function">label</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tr_data <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
model <span class="token operator">=</span> <span class="token function">train</span><span class="token punctuation">(</span>tr_label<span class="token punctuation">,</span><span class="token function">sparse</span><span class="token punctuation">(</span>tr_data<span class="token punctuation">)</span><span class="token operator">&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This is where <code>liblinear</code> comes in. We use the function <code>train()</code> and pass the variables <code>tr_label</code> for the labels and <code>tr_data</code> for the image data. As the image data contains a lot of zero values (black pixels in the background), we use <code>sparse()</code> to convert it into a sparse matrix first. A sparse matrix lists non-zero elements by identifying their positions and then defining their values:</p>
<figure>
  <p align="center"> <img src="./resources/sparse.png" width="500"> </p>
  <figcaption>Figure 3 - A sparse matrix</figcaption>
</figure>
<p>The complete documentation for <code>sparse()</code> can be found <a href="https://docs.octave.org/v8.2.0/Creating-Sparse-Matrices.html">here</a>.</p>
<p>After training a model, we can then validate the model by testing it against the validation dataset:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token comment">% use 1000 samples to check accuracy of the model</span>
te_label <span class="token operator">=</span> <span class="token function">label</span><span class="token punctuation">(</span><span class="token number">5001</span><span class="token operator">:</span><span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
te_data <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5001</span><span class="token operator">:</span><span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pred_label <span class="token operator">=</span> <span class="token function">predict</span><span class="token punctuation">(</span>te_label<span class="token punctuation">,</span><span class="token function">sparse</span><span class="token punctuation">(</span>te_data<span class="token punctuation">)</span><span class="token operator">&apos;</span><span class="token punctuation">,</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Using the 5001<sup>th</sup> to 6000<sup>th</sup> images, <code>predict()</code> makes the model guess what digits are written in every one of them, and takes note if the guesses were correct or not. An accuracy number can then be obtained. Additionally, we store the model&apos;s guesses in <code>pred_label</code>.</p>
<p>To show visualizations of the trained weights, we can show the weights stored in <code>model.w</code> in image form.</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span>&quot;Visualization of trained weights&quot;<span class="token punctuation">)</span>
<span class="token keyword keyword-for">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span>
  <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token comment">% create subplots</span>
  plotTitle <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">Label</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Assigning correct labels to the weights</span>
  rescaled <span class="token operator">=</span> <span class="token function">scaleimg</span><span class="token punctuation">(</span><span class="token function">reshape</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% reshape and rescale</span>
  fileName <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span>&quot;<span class="token operator">./</span>weights<span class="token operator">/</span>weight_<span class="token comment">%d.png&quot;, model.Label(i)); % assign file names</span>
  <span class="token function">imshow</span><span class="token punctuation">(</span>rescaled<span class="token punctuation">)</span> <span class="token comment">% Show image in plot window</span>
  <span class="token function">imwrite</span><span class="token punctuation">(</span>rescaled<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span> <span class="token comment">% Write image to png file in weights subfolder</span>
  <span class="token function">title</span><span class="token punctuation">(</span>plotTitle<span class="token punctuation">)</span> <span class="token comment">% Title subplot accordingly</span>
<span class="token keyword keyword-end">end</span>
</pre><p>Iterating through the 10 different weights, we create a new subplot for each one, and title them accordingly using the weight labels stored in <code>model.Label</code>. We then reshape and rescale the images to be 28 by 28 pixel images with the correct brightness levels (<code>scaleimg</code> is a user-defined function explained in report 11). We also assign a file name to store it in the subfolder <code>weights/</code>. We then show and write the rescaled images, titling and naming the files accordingly.</p>
<h3 class="mume-header" id="visualized-weights">Visualized weights</h3>

<p>The visualization of the weights are as follows:</p>
<figure>
  <p align="center"> <img src="./weights/weights.png" width="500"> </p>
  <figcaption>Figure 4 - Visualization of the trained weights</figcaption>
</figure>
<p>The weights don&apos;t contain a lot of information by themselves, but they do tell us some information about where the model looks at. Whiter pixels mean a lot of the images with the same label occupy those pixels. That said, the weights don&apos;t particularly look like numbers.</p>
<p>Trying to play around with the brightness and contrast in Photoshop:</p>
<figure>
  <p align="center"> <img src="./resources/weight_7-contrast.png" width="300"> </p>
  <p align="center"> <img src="./resources/weight_7-contrast-guide.png" width="300"> </p>
  <figcaption>Figure 5 - Weight 7 with contrast and brightness adjustments</figcaption>
</figure>
<p>Weight 7 forms a (very) faint 7 shape, but it is uncertain whether this is a coincidence or a very slight peek at the pattern the model considers.</p>
<h2 class="mume-header" id="exercise-121">Exercise 12.1</h2>

<p>Assuming everything in Lecture 12 was done correctly, we are ready to do exercise 12.1.</p>
<p align="center"> <img src="./resources/CAPS12_Assignment.png" width="500"> </p>
<p>We are asked to make to hand-written images, one that can be recognized correctly by the model and another that cannot be recognized correctly.</p>
<p>To make the images, the program Adobe Photoshop 2023 was used. A 28 by 28 pixel document was created and the background was filled with black. The digits are drawn using the brush tool with brush size 3 and color white. No pressure-sensitive drawing tablet was used&#x2014;both images were drawn with a computer mouse.</p>
<figure>
  <p align="center"> <img src="./handwritten/handwritten0.png" width="200"> </p>
  <figcaption>Figure 6 - Handwritten zero</figcaption>
</figure>
<figure>
  <p align="center"> <img src="./handwritten/handwritten8.png" width="200"> </p>
  <figcaption>Figure 7 - Handwritten five</figcaption>
</figure>
<p>The digits 0 and 8 were chosen arbitrarily. The .psd files were exported into 8-bit grayscale .png and loaded into Octave:</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab">sample <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">&apos;./handwritten/handwritten0.png&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% read handwriting image</span>
sample <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>sample<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Convert into grayscale</span>
</pre><p><code>mean(sample,3)</code> is used to convert .png files that are not in grayscale into grayscale. The number 3 specifies the dimension in which the mean is calculated. Passing a value of <code>1</code> will calculate the mean of each column and return a row vector. Passing <code>2</code> calculates the mean of each row and returns a column vector, while passing <code>3</code> calculates the mean of each element in a 3D matrix (usually used to represent a tensor).</p>
<figure>
  <p align="center"> <img src="./resources/tensor.jpg" width="500"> </p>
  <figcaption>Figure 8 - A 3D matrix</figcaption>
</figure>
<p>As a color .png file has 3 channels for red, green and blue, it is represented by 3 matrices, one for each channel. To make it grayscale, we take the mean of the brightness values in each channel&apos;s pixels. However, as our images are already in grayscale, this line is not needed. We choose to keep it for compatibility purposes when using other images.</p>
<p>Using the previously trained model to predict the digit,</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab"><span class="token function">predict</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">sparse</span><span class="token punctuation">(</span><span class="token function">reshape</span><span class="token punctuation">(</span>sample<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>model<span class="token punctuation">)</span> <span class="token comment">% Predict the digit shown</span>
</pre><p>We need to first reshape the image data matrix into a sparse row vector, because that is the format we used to train the model. We also pass the single entry vector <code>[0]</code> to tell the function that the correct label would be 0. Lastly, we pass the model that we&apos;ve aptly named <code>model</code> to use for the prediction.</p>
<p>For the other file, we do exactly the same things, paying attention to change the file name and label.</p>
<pre data-role="codeBlock" data-info="matlab" class="language-matlab">sample <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">&apos;./handwritten/handwritten8.png&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% read handwriting image</span>
sample <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>sample<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Convert into grayscale</span>
<span class="token function">predict</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">sparse</span><span class="token punctuation">(</span><span class="token function">reshape</span><span class="token punctuation">(</span>sample<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>model<span class="token punctuation">)</span> <span class="token comment">% Predict the digit shown</span>
</pre><p>Running the script, the following output was obtained:</p>
<figure>
  <p align="center"> <img src="./resources/learnDigits.png" width="500"> </p>
  <figcaption>Figure 9 - Output of learnDigits.m</figcaption>
</figure>
<p>The model correctly guesses the handwritten 0, but fails to guess 8 correctly.</p>
<h3 class="mume-header" id="factors-of-predictive-accuracy">Factors of predictive accuracy</h3>

<p>Even though the model had an accuracy of 88% when tested against the validation set, it failed to recognize the handwritten eight. This can be due to a variety of factors, but one in particular is that he model was trained on a very specific format of files. All the handwriting in the MNIST database followed the same set of rules and has the same characteristics. This gets the trained model used to said characteristics, and when the new testing image doesn&apos;t have the same characteristics, the model can&apos;t use the patterns it has learned from the training dataset and apply it to identify the new testing image, as it doesn&apos;t have the properties that the training data has.</p>
<p>Modern Optical Character Recognition (OCR) software uses models trained by much, much larger and more variative datasets. Some, even, are constantly learning, trained and validated by new data to get better and evolve at recognizing handwriting. To create a recognition model that can recognize actual handwriting, we need a larger and more general dataset than the MNIST dataset. This way we can try to test the model against samples that don&apos;t necessarily follow the properties exhibited by its training datasets, and still get a high accuracy of prediction.</p>
<br>
<p><em>The complete working directory for Report 12 can be accessed <a href="https://drive.google.com/drive/folders/1N0V1Mea96AFzF84LnRhheJvTVexkqG7c?usp=sharing">here</a>.</em></p>
<br>
<style>
  figcaption{
    text-align:center;
    font-size:9pt
  }
  img{
    filter: drop-shadow(0px 0px 5px );
  }
  .noshadow{
    filter: none;
  }
</style>
      </div>
      <div class="md-sidebar-toc">
<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open>
        <summary class="md-toc-link-wrapper">
          <a href="#report-12" class="md-toc-link"><p>Report 12</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open>
        <summary class="md-toc-link-wrapper">
          <a href="#introduction-to-linear-classification-and-basic-machine-learning" class="md-toc-link"><p>Introduction to linear classification and basic machine learning</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#an-example" class="md-toc-link">
            <p>An example</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open>
        <summary class="md-toc-link-wrapper">
          <a href="#what-was-done-in-lecture-12" class="md-toc-link"><p>What was done in Lecture 12</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#loading-the-mnist-dataset-into-octave" class="md-toc-link">
            <p>Loading the MNIST dataset into Octave</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#using-liblinear-for-linear-classification" class="md-toc-link">
            <p>Using <code>liblinear</code> for linear classification</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#portioning-data-for-training-and-validation" class="md-toc-link">
            <p>Portioning data for training and validation</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#visualized-weights" class="md-toc-link">
            <p>Visualized weights</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open>
        <summary class="md-toc-link-wrapper">
          <a href="#exercise-121" class="md-toc-link"><p>Exercise 12.1</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#factors-of-predictive-accuracy" class="md-toc-link">
            <p>Factors of predictive accuracy</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>